<% cache video do %>
  <div class="grid-item col-md-4 mb-4" data-category="<%= video.category %>">
    <div class="card h-100" data-controller="video-preview" data-action="mouseenter->video-preview#mouseEnter mouseleave->video-preview#mouseLeave">
      <div class="video-thumbnail ratio ratio-16x9 position-relative">
        <% if video.video_file.attached? %>
          <!-- Poster image that shows by default -->
          <div class="poster-image position-absolute top-0 start-0 w-100 h-100 bg-dark d-flex align-items-center justify-content-center" data-video-preview-target="poster">
            <i class="fas fa-play text-white fs-1"></i>
          </div>
          
          <!-- Video that plays on hover -->
          <video 
            class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover" 
            muted 
            preload="metadata" 
            data-video-preview-target="video"
            style="opacity: 0;"
          >
            <source src="<%= url_for(video.video_file) %>" type="<%= video.video_file.content_type %>">
          </video>
          
          <span class="duration position-absolute bottom-0 end-0 bg-dark text-white px-2 py-1 m-2 rounded z-index-1">2:56</span>
        <% end %>
      </div>
      <div class="card-body">
        <h5 class="card-title"><%= video.title %></h5>
        <p class="card-text"><%= truncate(video.description, length: 100) %></p>
        <span class="badge bg-primary"><%= video.category_name %></span>
      </div>
    </div>
  </div>
<% end %>